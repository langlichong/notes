# Unity 数字孪生 (Digital Twin) 开发指南

使用 Unity 开发数字孪生（工业、建筑、医疗等非游戏领域）与开发游戏有本质区别，主要体现在**授权模式**、**数据流**和**工具链**上。

---

## 1. 关键门槛：Unity Industry 授权

这是最大的坑，请务必注意。
从 2024 年起，如果你开发的不是“娱乐游戏”而是“工业应用”，Unity 使用了完全不同的授权体系。

*   **游戏开发**：可以用 Personal (免费) / Pro (收费)。
*   **数字孪生/工业**：通常强制要求购买 **Unity Industry**。
    *   **适用范围**：汽车、制造、政府、建筑、能源等行业。
    *   **价格**：比 Pro 版更贵（约 $4,950 /席位/年）。
    *   **包含服务**：它打包了 **Pixyz**（必用的模型转换工具）和 **Mars**（AR工具）以及企业级支持。

> **如果是接外包**：甲方是工业大厂，那么交付的工程文件必须是基于合法 Industry 授权的，否则甲方可能有法务风险。

---

## 2. 核心工作流：从“模型”到“数据”

数字孪生 = **高精模型 (Visual)** + **实时数据 (Data)**。

### A. 模型导入 (The Pipeline)
工业模型（CAD/BIM）通常也是几亿个面，直接放进 Unity 会卡死。
*   **工具**：**Pixyz Plugin** (现在包含在 Industry 订阅里)。
*   **作用**：它能读取 SolidWorks, Revit, Catia 等原始格式，并自动进行**减面、合并、UV展开**，将其转化为 Unity 能跑得动的 Mesh。
*   **不推荐做法**：不要试图手动用 3ds Max 转 OBJ，对于复杂工业结构，Pixyz 是唯一高效的自动化方案。

### B. 数据驱动 (IoT Integration)
这与我们之前讨论的 MQTT/流处理高度相关。
*   **游戏**：靠逻辑驱动（点击发射子弹）。
*   **孪生**：靠数据驱动（传感器温度 > 50 -> 机器模型变红）。
*   **推荐方案**：
    1.  **MQTT**：在 Unity C# 中集成 `M2Mqtt` 或 `HiveMQ` 客户端。
    2.  **数据映射**：建立一个 `Dictionary<SensorID, GameObject>`。
    3.  **UI 绑定**：当 MQTT 消息到来时，更新 3D 标签或改变材质颜色。

---

## 3. 关键技术栈

| 需求 | Unity 解决方案 | 备注 |
| :--- | :--- | :--- |
| **超大场景渲染** | **HDRP (高清渲染管线)** | 必须用 HDRP 才能做出那种很有“科技感”的光影和材质。 |
| **BIM 信息查看** | **Unity Reflect** | 允许从 Revit 一键同步到 Unity，并保留 BIM 属性（如材质、尺寸、供应商）。 |
| **物理仿真** | **Unity SystemGraph** | 用于模拟传感器逻辑（如激光雷达、摄像头）的节点化工具。 |
| **海量物体** | **DOTS (ECS)** | 如果你要在一个屏幕里显示 10 万个物流包裹，传统的 GameObject 会卡死，必须用 ECS。 |

---

## 4. Unity vs Unreal Engine (UE5) 怎么选？

*   **选 Unity 如果**：
    *   你需要跑在 **Web (WebGL)**、手机或低配工控机上。
    *   你的团队熟悉 C# 和 .NET 生态（容易对接企业级后端）。
    *   你需要做大量定制的互动逻辑（Unity 的 C# 开发效率高于 UE 的 C++）。
*   **选 UE5 如果**：
    *   你需要**电影级**的画质（Nanite/Lumen），且只跑在高端 PC 上。
    *   你的场景是超大规模城市（CitySample）。

### 总结
做数字孪生，Unity 仍然是目前**兼容性最好、落地最快**的引擎，特别是针对 Web端展示和 IoT 数据对接。但请务必搞定 **Pixyz 流程** 和 **Industry 授权** 这两个拦路虎。
